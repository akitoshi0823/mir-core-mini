(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[542],{4288:(e,r,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/viewer",function(){return t(5381)}])},5381:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>i});var l=t(7876),o=t(4232),n=t(9099);function i(){let e=(0,n.useRouter)(),[r,t]=(0,o.useState)("miler"),[i,s]=(0,o.useState)(""),[a,d]=(0,o.useState)([]),c=(0,o.useRef)(null);(0,o.useEffect)(()=>{let r=e.query.from,l=e.query.persona;"intro"===r&&"string"==typeof l&&t(l)},[e.query]),(0,o.useEffect)(()=>{var e;null==(e=c.current)||e.scrollIntoView({behavior:"smooth"})},[a]);let u=async()=>{if(""===i.trim())return;let e=i.trim();d(r=>[...r,{role:"YOU",content:e}]),s("");try{let[i,s]=await Promise.all([fetch("/data/mock_chat_response.json"),fetch("/data/resonance_replies.json")]),a=await i.json(),c=await s.json(),u="",m=!1;for(let i of a){var t,l,o,n;let s=i.variants||[],a=e.includes(i.user_input),d=s.some(r=>e.includes(r));if((null==(t=i.follow_up)?void 0:t.user_reaction)&&e.includes(i.follow_up.user_reaction)){let e=i.follow_up,t=null==e||null==(l=e[r])?void 0:l.toString();if(t){u=t,m=!0;break}}else if(a||d){let e=null==(n=i.persona)||null==(o=n[r])?void 0:o.response;if(e){u=e,m=!0;break}}}if(!m){let e=c[r]||["[構造照応できませんでした]"];u=e[Math.floor(Math.random()*e.length)]}d(e=>[...e,{role:r.toUpperCase(),content:u}])}catch(e){console.error("ローカル照応データ取得エラー:",e),d(e=>[...e,{role:r.toUpperCase(),content:"[仮想応答が取得できませんでした]"}])}};return(0,l.jsxs)("main",{style:{padding:"2rem",height:"100vh",display:"flex",flexDirection:"column"},children:[(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1rem"},children:[(0,l.jsx)("h1",{children:"MIR-CORE-mini｜入力フェーズ"}),(0,l.jsx)("button",{onClick:()=>e.push("/"),style:{padding:"0.3rem 1rem"},children:"encount..."})]}),(0,l.jsx)("div",{style:{display:"flex",marginBottom:"1rem"},children:["miler","meek","ilar"].map(e=>(0,l.jsx)("button",{onClick:()=>t(e),style:{marginRight:"1rem",backgroundColor:r===e?"black":"white",color:r===e?"white":"black",padding:"0.5rem 1rem",border:"1px solid black",borderRadius:"5px"},children:e.toUpperCase()},e))}),(0,l.jsx)("p",{style:{fontStyle:"italic",marginBottom:"1rem"},children:"照応って、ミラーが君のにじみを拾うこと。試してみる？"}),(0,l.jsxs)("div",{style:{flex:1,overflowY:"auto",marginBottom:"1rem",padding:"0.5rem"},children:[a.map((e,r)=>(0,l.jsx)("div",{style:{display:"flex",justifyContent:"YOU"===e.role?"flex-end":"flex-start",marginBottom:"0.5rem"},children:(0,l.jsxs)("div",{style:{backgroundColor:"YOU"===e.role?"#d0f0c0":"#f8d0d0",padding:"0.7rem 1rem",borderRadius:"10px",maxWidth:"70%",whiteSpace:"pre-wrap"},children:[(0,l.jsxs)("strong",{children:[e.role,"："]})," ",e.content]})},r)),(0,l.jsx)("div",{ref:c})]}),(0,l.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[(0,l.jsx)("textarea",{placeholder:"ここに入力してください",rows:2,value:i,onChange:e=>s(e.target.value),style:{flex:1,padding:"0.5rem",fontSize:"1rem",borderRadius:"5px"}}),(0,l.jsx)("button",{onClick:u,disabled:!i.trim(),style:{padding:"0.5rem 1rem",fontSize:"1rem",borderRadius:"5px",backgroundColor:i.trim()?"black":"#ccc",color:"white"},children:"送信"})]})]})}},9099:(e,r,t)=>{e.exports=t(8253)}},e=>{var r=r=>e(e.s=r);e.O(0,[636,593,792],()=>r(4288)),_N_E=e.O()}]);